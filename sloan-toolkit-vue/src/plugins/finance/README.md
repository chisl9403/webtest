# 💰 金融插件 (Finance Plugin)

## 📖 功能概览

金融插件是一个全面的股票市场信息展示工具，集成了大盘指数、K线图、资金流向、热门股票和龙虎榜等功能。

## ✨ 核心功能

### 1. 🎯 大盘指数
- 实时显示沪深两市主要指数
- 支持指数：上证指数、深证成指、创业板指、沪深300
- 显示信息：最新价、涨跌额、涨跌幅
- 卡片式展示，响应式布局
- 自动刷新功能

### 2. 🥇 黄金行情
- 实时显示黄金价格
- 支持品种：上海黄金现货、黄金期货主力合约
- 显示信息：最新价、涨跌额、涨跌幅
- 与大盘指数同行展示

### 3. 📈 期货涨幅榜 TOP5
- 实时显示涨幅最高的5个期货合约
- 覆盖市场：中金所、上期所、大商所、郑商所、能源中心
- 显示信息：合约名称、最新价、涨跌幅、涨跌额、成交量
- 表格式展示，支持实时刷新

### 4. 📈 K线图
- 交互式K线图（蜡烛图）
- 支持多指数切换（上证/深证/创业板/沪深300）
- 显示最近120个交易日数据
- 内置缩放工具（鼠标滚轮 + 滑块）
- 详细提示信息（开盘价、收盘价、最高价、最低价）
- 红色阳线、绿色阴线（中国市场标准）

### 5. 💰 资金流向图
- 主力资金净流入/流出趋势
- 柱状图 + 折线图组合
- 资金流向与涨跌幅对比
- 最近30个交易日数据
- 红绿配色（流入红色、流出绿色）

### 6. 🔥 热门股票 TOP5
- 按涨幅排序
- 显示信息：股票名称、代码、最新价、涨跌幅、换手率
- 实时更新
- 独立刷新按钮

### 7. 📊 龙虎榜 TOP5
- 按主力资金净流入排序
- 显示信息：股票名称、代码、最新价、涨跌幅、净流入额
- 显示交易日期
- 数据失败时自动降级显示示例数据

## 🎨 界面布局

```
┌─────────────────────────────────────────────────┐
│  [刷新全部数据]                                  │
├─────────────────────────────────────────────────┤
│  大盘指数 + 黄金行情（同一行）                   │
│  ┌──────┐ ┌──────┐ ┌──────┐ ┌──────┐ ┌──────┐ │
│  │上证  │ │深证  │ │创业  │ │沪深  │ │上海  │ │
│  │指数  │ │成指  │ │板指  │ │300   │ │黄金  │ │
│  └──────┘ └──────┘ └──────┘ └──────┘ └──────┘ │
│  ┌──────┐                                      │
│  │黄金  │                                      │
│  │期货  │                                      │
│  └──────┘                                      │
├─────────────────────────────────────────────────┤
│  📈 K线图        [上证指数 ▼]                    │
│  ┌──────────────────────────────────────────┐   │
│  │                                          │   │
│  │         蜡烛图 + 缩放工具                 │   │
│  │                                          │   │
│  └──────────────────────────────────────────┘   │
│  💰 资金流向                                     │
│  ┌──────────────────────────────────────────┐   │
│  │                                          │   │
│  │      柱状图 + 折线图                      │   │
│  │                                          │   │
│  └──────────────────────────────────────────┘   │
├─────────────────────────────────────────────────┤
│  � 期货涨幅榜 TOP5                              │
│  ┌─────────────────────────────────────────┐   │
│  │  合约表格（涨幅前5）                     │   │
│  └─────────────────────────────────────────┘   │
├─────────────────────────────────────────────────┤
│  �🔥 热门股票 TOP5          📊 龙虎榜 TOP5       │
│  ┌────────────────────┐   ┌─────────────────┐  │
│  │  股票表格          │   │  股票表格        │  │
│  └────────────────────┘   └─────────────────┘  │
└─────────────────────────────────────────────────┘
```

## 🔧 技术实现

### 数据源
- **东方财富 API** (East Money)
  - 大盘指数：`push2.eastmoney.com/api/qt/ulist.np/get`
  - 期货涨幅榜：`push2.eastmoney.com/api/qt/clist/get` (期货市场)
  - 黄金行情：`push2.eastmoney.com/api/qt/stock/get`
  - K线数据：`push2his.eastmoney.com/api/qt/stock/kline/get`
  - 资金流向：`push2.eastmoney.com/api/qt/stock/fflow/kline/get`
  - 热门股票：`push2.eastmoney.com/api/qt/clist/get`
  - 龙虎榜：`datacenter-web.eastmoney.com/api/data/v1/get`

### 图表库
- **ECharts 5.x**
  - 蜡烛图（Candlestick Chart）
  - 柱状图（Bar Chart）
  - 折线图（Line Chart）
  - 数据缩放（DataZoom）
  - 交互式提示（Tooltip）

### UI 框架
- **Element Plus 2.5**
  - 卡片组件（Card）
  - 表格组件（Table）
  - 选择器（Select）
  - 按钮（Button）
  - 加载状态（Loading）

## 📦 依赖项

```json
{
  "echarts": "^5.4.3",
  "vue-echarts": "^7.0.3",
  "element-plus": "^2.5.3"
}
```

## 🚀 使用方法

### 基础使用

```vue
<template>
  <FinancePlugin />
</template>

<script setup>
import FinancePlugin from '@/plugins/finance/FinancePlugin.vue'
</script>
```

### 作为插件注册

```typescript
// src/plugins/finance/index.ts
import type { Plugin } from '@/types/plugin'
import FinancePlugin from './FinancePlugin.vue'

export default {
  id: 'finance',
  name: '金融',
  icon: '💰',
  component: FinancePlugin,
  enabled: true,
  order: 2
} as Plugin
```

## 🔄 数据刷新

### 自动刷新
- 组件挂载时自动加载所有数据
- 使用 `onMounted` 生命周期钩子

### 手动刷新
1. **全部数据刷新**：点击顶部"刷新全部数据"按钮
2. **股票数据刷新**：点击热门股票卡片的"刷新"按钮

### 指数切换
- 在K线图区域选择不同指数
- 自动刷新K线图和资金流向图

## 💡 交互功能

### K线图交互
1. **鼠标滚轮**：在图表区域滚动缩放
2. **拖拽**：拖动图表查看不同时间段
3. **滑块**：使用底部滑块调整显示范围
4. **悬停提示**：鼠标悬停显示详细数据

### 资金流向图交互
1. **悬停提示**：显示当日资金流向和涨跌幅
2. **图例切换**：点击图例显示/隐藏数据系列

## 🎯 数据说明

### 大盘指数
- **最新价**：实时价格
- **涨跌额**：与昨日收盘价差值
- **涨跌幅**：涨跌百分比

### K线图
- **红色蜡烛**：阳线（收盘价 > 开盘价）
- **绿色蜡烛**：阴线（收盘价 < 开盘价）
- **上影线**：最高价
- **下影线**：最低价

### 资金流向
- **主力净流入**：大单 + 超大单净流入额（亿元）
- **正值（红色）**：资金流入
- **负值（绿色）**：资金流出

### 热门股票
- **涨幅榜**：按涨跌幅降序排列
- **换手率**：成交量/流通股本
- **实时数据**：最新交易数据

### 龙虎榜
- **上榜条件**：日涨跌幅偏离值达7%、日振幅达15%等
- **净流入**：上榜席位买入-卖出（亿元）
- **交易日**：显示数据所属交易日

## ⚠️ 注意事项

### API 限制
- 东方财富API为公开接口，无需密钥
- 建议添加请求防抖，避免频繁刷新
- 建议实现数据缓存机制

### 数据时效
- 交易日数据：实时更新（有延迟）
- 非交易日：显示最后一个交易日数据
- 周末和节假日：自动回溯至上一交易日

### 错误处理
- API失败时显示友好错误提示
- 龙虎榜数据失败时自动显示示例数据
- 网络错误时保留上次加载的数据

### 性能优化
- 使用 ECharts 按需引入
- 懒加载大量数据
- 响应式布局，移动端优化

## 📱 响应式支持

### 桌面端 (≥ 1200px)
- 4列大盘指数
- 左右分栏K线图和资金流向图
- 左右分栏热门股票和龙虎榜

### 平板端 (768px - 1199px)
- 4列大盘指数
- 单列K线图和资金流向图
- 左右分栏热门股票和龙虎榜

### 移动端 (< 768px)
- 2列大盘指数
- 单列所有内容
- 缩小字体和间距
- 简化图表高度

## 🎨 样式定制

### 主题色
```scss
// 背景渐变
background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);

// 卡片头部渐变
background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);

// 阳线/流入
color: #ec0000;

// 阴线/流出
color: #00da3c;

// 折线
color: #409eff;
```

## 🐛 常见问题

### 1. 图表不显示
- 检查 ECharts 是否正确安装
- 确认 `use()` 注册了必要组件
- 查看浏览器控制台错误信息

### 2. 数据加载失败
- 检查网络连接
- 查看 API 是否返回数据
- 确认 CORS 设置正确

### 3. K线图显示异常
- 检查数据格式是否正确
- 确认日期格式符合要求
- 验证 OHLC 数据顺序

### 4. 移动端显示问题
- 检查响应式断点
- 调整 `el-col` 的 `xs/sm/md/lg` 属性
- 测试不同设备尺寸

## 📚 相关文档

- [ECharts 官方文档](https://echarts.apache.org/)
- [Element Plus 文档](https://element-plus.org/)
- [东方财富 API 开发资源](./EASTMONEY_API_GUIDE.md)
- [Vue 3 组合式 API](https://vuejs.org/guide/extras/composition-api-faq.html)

## 🔮 未来计划

- [ ] 自选股功能
- [ ] 股票搜索
- [ ] 更多技术指标（MACD、RSI、KDJ等）
- [ ] 分时图
- [ ] 历史数据回溯
- [ ] 数据导出功能
- [ ] 自定义刷新间隔
- [ ] WebSocket 实时数据推送
- [ ] 多主题支持
- [ ] 国际化支持

## 📄 许可证

本插件仅供学习研究使用，数据来源于公开API，商业用途请联系数据提供方获取授权。

---

**版本**: 2.0.0  
**更新日期**: 2024年  
**作者**: Sloan Toolkit Team
